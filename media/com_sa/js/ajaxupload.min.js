function $m(e){return document.getElementById(e)}function remove(e){e.parentNode.removeChild(e)}function sa_addEvent(e,t,a){e.addEventListener&&e.addEventListener(t,a,!0),e.attachEvent&&e.attachEvent("on"+t,a)}function removeEventAd(e,t,a){e.detachEvent?e.detachEvent("on"+t,a):e.removeEventListener(t,a,!1)}function ajaxUpload(e,t,a,i,r){if(!html5FileCheck())return document.getElementById("ad_image").value="",!1;var n=jQuery("#ad_image").val().split("/").pop().split("\\").pop();jQuery("#ad_img_box #direct_upload .uneditable-input .fileupload-preview").text(n),jQuery("#ad_img_box #direct_upload .uneditable-input .icon-file").show();var o="";if(null==(e="string"==typeof e?$m(e):e)||void 0===e?o+="The form of 1st parameter does not exists.\n":"form"!=e.nodeName.toLowerCase()&&(o+="The form of 1st parameter its not a form.\n"),null==$m(a)&&(o+="The element of 3rd parameter does not exists.\n"),o.length>0){alert("Error in call ajaxUpload:\n"+o);return}var m=document.createElement("iframe");m.setAttribute("id","ajax-temp"),m.setAttribute("name","ajax-temp"),m.setAttribute("width","0"),m.setAttribute("height","0"),m.setAttribute("border","0"),m.setAttribute("style","width: 0; height: 0; border: none;"),e.parentNode.appendChild(m),window.frames["ajax-temp"].name="ajax-temp";var d=function(){removeEventAd($m("ajax-temp"),"load",d);var e="javascript: ";e+="window.parent.$m('"+a+"').innerHTML = document.body.innerHTML; void(0);",$m(a).innerHTML=r,$m("ajax-temp").src=e,setTimeout(function(){remove($m("ajax-temp"))},250)};sa_addEvent($m("ajax-temp"),"load",d),e.setAttribute("target","ajax-temp"),e.setAttribute("action",root_url+"index.php?option=com_sa&task=create.saveMedia"+t),e.setAttribute("method","post"),e.setAttribute("enctype","multipart/form-data"),e.setAttribute("encoding","multipart/form-data"),e.setAttribute("success",void setTimeout(function(){jQuery("#upload_area .errorPresent").length&&(jQuery("#ad_image").val(""),alert(Joomla.JText._("COM_SOCIALADS_ERR_SOMETHING_WENT_WRONG")))},2500)),e.upimg&&(e.upimgcopy.value=e.upimg.value),i.length>0&&($m(a).innerHTML=i),e.submit()}function html5FileCheck(){if(window.File&&window.FileReader&&window.FileList&&window.Blob){var e=techjoomla.jQuery("#ad_image")[0].files[0].size,t=techjoomla.jQuery("#ad_image")[0].files[0].type;if(e>saAllowedMediaSize)return alert(Joomla.JText._("COM_SOCIALADS_ERR_MSG_FILE_BIG_JS")),!1;console.log(t),console.log(saAllowedMimeTypes);var a=saAllowedMimeTypes;return"html5_zip"==techjoomla.jQuery(".sa-form #adtype").val()&&(a=["application/zip","application/x-zip-compressed"]),-1!=techjoomla.jQuery.inArray(t,a)||(alert(Joomla.JText._("COM_SOCIALADS_ERR_MSG_FILE_ALLOW")),!1)}}